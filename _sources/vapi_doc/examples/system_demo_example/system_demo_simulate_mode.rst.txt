.. _vapi-system_example_simulate:

Application in simulation mode
==============================

In ``<outputfolder>/examples/bin`` start the application with following parameter: ``sys_demo_example -f../../bin --simulate``.

The path is the path to the :term:`VAPI Framework` binaries e.g. ``sdv_control``.


.. image:: ../../../vapi_media/examples/system_demo_example/system_demo_screnshot_simulation.png


First, we have the Initialization phase, where we have to load the required components. During loading of the components, the core system is in configuration mode. That means, the components are loaded and configured. After every component is loaded, we have to switch to running mode.

The example in simulation mode does not load the Data Link, therefore there are no signals. In this case, we have to create them (registering) in the dispatch service and before shutdown to reset them.


.. image:: ../../../vapi_media/examples/system_demo_example/system_demo_simulation_mode.png

After test-run we have to unregister the signals for a graceful shutdown.

.. uml::
   :caption: Shutdown sequence

   @startuml
   
   skinparam BackgroundColor #A2D3D6
   Participant "Example Application" as EA #00A7AB
   Participant "CExample Control (Utility)" as EC #00A7AB
   Participant "CAppControl" as AC #BFBFBF

   EA->EC : CExampleControl::StartTestRun()
   activate EC #00A7AB
   EC->EC : Switch to simulation mode (Can't Load further services)
   EC->EC : Test Run Starts
   EC-->EA 
   deactivate EC

   EA->EC : CExampleControl::StopTestRun()
   activate EC #00A7AB
   EC->EC : Test Run Stops
   EC-->EA 
   deactivate EC
   
   EA->EC : CExampleControl::ResetSignalsSimDatalink()
   activate EC #00A7AB
   EC->EC : Reset simulated signals
   EC-->EA 
   deactivate EC

   EA->EC : CExampleControl::Shutdown()
   activate EC #00A7AB
   EC->AC : CAppControl::Shutdown()
   activate AC #BFBFBF
   AC->AC : Shutdown the application
   AC-->EC
   deactivate AC #BFBFBF 
   EC-->EA 
   deactivate EC

   @enduml


